# 环境

- Ubuntu Server 最新LTS

- msql

  > sudo apt-get install mysql-server mysql-client
  >
  > sudo apt-get install libmysqlclient-dev
  >
  > 需要的头文件出现在/usr/include/mysql中

  - 配置mysql的用户名root密码

    ```bash
    sudo mysql_secure_installation
    ```

  - 修改远程连接的配置文件

    ```bash
    sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf 
    # 注释掉 bind-address           = 127.0.0.1
    ```

  - 新建用户并授权

    ```mysql
    create user 'chuancey'@'%' identified by 'Zhangsan@elem123';
    
    grant all on *.* to 'chuancey'@'%';
    ```

    

  - 查看所有的开放端口

    ```bash
    netstat -aptn
    ```

  - 查看mysql是否运行

    ```bash
    sudo netstat -tap | grep mysql
    ```


# 用到的工具

C# 连接数据库用到官方的库`MySql.Data.dll`



在用xshell操作vim时用ctrl+s会导致xshell假死，按ctrl+q退出假死状态

# 下一步的规划

通过wireshark抓包发现百度网盘的下载采用的是http协议，实现http协议的方式写web服务器



web服务器用epoll+线程池实现。：：学习使用IO复用函数：select、poll、epoll

从main函数开始一点点实现！

- 单例化
- 系统日志的使用
- 命令行解析：线程数、后台运行、杀死后台、帮助文档

- 要完成http请求的解析！



- c语言执行sql命令

  C语言交互数据库要用到`<mysql/mysql.h>`头文件，编译时需要加参数`-lmysqlclient`

  与MySQL交互时，应用程序应使用该一般性原则：

  1. 通过调用mysql_library_init()，初始化MySQL库。库可以是mysqlclient  C客户端库，或mysqld嵌入式服务器库，具体情况取决于应用程序是否与“-libmysqlclient”或“-libmysqld”标志链接。

  2. 通过调用mysql_init()初始化连接处理程序，并通过调用mysql_real_connect()连接到服务器。

  3. 发出SQL语句并处理其结果。

     1. 通过调用mysql_store_result()，一次性地检索整个结果集。该函数能从服务器获得查询返回的所有行，并将它们保存在客户端
     2. 第二种方式是针对客户端的，通过调用mysql_use_result()，对“按行”结果集检索进行初始化处理。该函数能初始化检索结果，但不能从服务器获得任何实际行。

     两种情况下，均能通过调用mysql_fetch_row()访问行。通过mysql_store_result()，mysql_fetch_row()能够访问以前从服务器获得的行。通过mysql_use_result()，mysql_fetch_row()能够实际地检索来自服务器的行。通过调用mysql_fetch_lengths()，能获得关于各行中数据大小的信息。

     **完成结果集操作后，请调用mysql_free_result()释放结果集使用的内存。**

  4. 通过调用mysql_close()，关闭与MySQL服务器的连接。

  5. 通过调用mysql_library_end()，结束MySQL库的使用。

- 两者交互用json传输

  > 发送方与接受发传输数据：
  >
  > 序列化------->网络传输--------->反序列化
  >
  > json序列化是指，将有key-value结构的数据类型（比如结构体、map、切片）序列化成json字符串的操作。
  >
  > json反序列化的过程是：将json字符串转换成相应的数据类型
  
  服务器端采用cjson的库操作json字符串

# 笔记

- 线程池中的线程数量应该和CPU数量差不多

- 线程池的实现

  一般来说实现一个线程池主要包括以下几个组成部分：

  1. **线程管理器：**用于创建并管理线程池。
  2. **工作线程：**线程池中实际执行任务的线程。在初始化线程时会预先创建好固定数目的线程在池中，这些初始化的线程一般处于空闲状态，一般不占用CPU，占用较小的内存空间。
  3. **任务接口：**每个任务必须实现的接口，当线程池的任务队列中有可执行任务时，被空闲的工作线程调去执行（线程的闲与忙是通过互斥量实现的，跟前面文章中的设置标志位差不多），把任务抽象出来形成接口，可以做到线程池与具体的任务无关。
  4. **任务队列：**用来存放没有处理的任务，提供一种缓冲机制，实现这种结构有好几种方法，常用的是队列，主要运用先进先出原理，另外一种是链表之类的数据结构，可以动态的为它分配内存空间，应用中比较灵活，下文中就是用到的链表。

- HTTP是无状态的、无连接的

  - 标准的http协议指的是不包括cookies, session，application的http协议，他们都不属于标准协议，虽然各种网络应用提供商，实现语言、web容器等，都默认支持它

    - 无状态的官方解释
      1. 协议对于事务处理没有记忆能力【事物处理】【记忆能力】
      2. 对同一个url请求没有上下文关系【上下文关系】
      3. 每次的请求都是独立的，它的执行情况和结果与前面的请求和之后的请求是无直接关系的，它不会受前面的请求应答情况直接影响，也不会直接影响后面的请求应答情况【无直接联系】【受直接影响】
      4. 服务器中没有保存客户端的状态，客户端必须每次带上自己的状态去请求服务器【状态】

  - 无连接：

    - 每一个访问都是无连接，服务器挨个处理访问队列里的访问，处理完一个就关闭连接，这事儿就完了，然后处理下一个新的
    - 无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接

    

  

- 三个IO多路复用函数的区别：
  - select最多只能支持1024个描述符，因为它是使用含有1024比特的long型数组的结构fd_set来“存放”监听的文件描述符，虽然可以在内核中修改此参数但是非常不方便。



- 解决每次git push都要输入账号密码

  - 原因是提交绑定的是https方式，需要改成ssh方式

    ```bash
    git remote rm origin
    git remote add origin ssh地址
    ```

- Ubuntu 安装软件时出现依赖问题：

  ```bash
  sudo apt install aptitude
  sudo aptitude install xxxx
  ```

- vimplus安装后可能还需要重新编译安装Youcompleteme插件，并安装clangd编译器并在这之前安装常见的编译工具

- 换电脑后同步仓库

  ```bash
  git init
  git remote add origin 项目地址
  git fetch origin
  git push --set-upstream origin master
  ```

- 使用syslog后，响应的日志可以通过命令查看

  ```bash
  cat /var/log/syslog | grep webServer
  ```

  













